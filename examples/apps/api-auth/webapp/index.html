<html>
  <body>

    <script src="https://unpkg.com/mithril/mithril.js"></script>

    <script>

      var token = ""

      var response = ""

      function ping() {
	m.request({
	  method: "GET",
	  url: "/api/ping",
	  headers: {
            "Authorization": "Bearer " + token,
            "Custom-Header": "value"
	  }
	})
	  .then(function(res) {
	    response = res
	  })
      }

      function get_token() {
	m.request({
	  method: "POST",
	  url: "/auth/token",
	  body: {
	    username: "foo",
	    password: "bar"
	  }
	})
	.then(function(res) {
	  token = res.token
	  return res.token
	})
      }

      function main() {
	return m("",
		 m("input", "Username"),
		 m('br'),
		 m("input", "Password"),
		 m("button", {onclick: get_token}, "Authenticate"))
      }

      var root = document.body;
      m.mount(root, {
	view: main
      })

    </script>
  </body>

</html>
